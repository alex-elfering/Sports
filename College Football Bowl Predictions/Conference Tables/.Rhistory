),
locations = cells_body(
columns = `11`,
rows = `11` >= 1
)
)%>%
tab_style(
style = list(
cell_text(color = "black")
),
locations = cells_body(
columns = `12`,
rows = `12` >= 1
)
) %>%
tab_style(
style = list(
cell_text(color = "black")
),
locations = cells_body(
columns = `13`,
rows = `13` >= 1
)
) %>%
gtsave(glue("{i} Week#{j} game predictions.png"), vwidth = 1100)
}else{
range_wins_table <- finishes_out_table %>%
fmt("0",
rows = `0` < 1,
fns = less_1) %>%
fmt("0",
rows = `0` == 0,
fns = no_percent) %>%
fmt("0",
rows = `0` > 99,
fns = greater_99) %>%
fmt("0",
rows = `0` == 100,
fns = percent_100) %>%
fmt("0",
rows = `0` < 99 & `0` >= 1,
fns = nor_percent) %>%
fmt("1",
rows = `1` < 1,
fns = less_1) %>%
fmt("1",
rows = `1` == 0,
fns = no_percent) %>%
fmt("1",
rows = `1` > 99,
fns = greater_99) %>%
fmt("1",
rows = `1` == 100,
fns = percent_100) %>%
fmt("1",
rows = `1` < 99 & `1` >= 1,
fns = nor_percent) %>%
fmt("2",
rows = `2` < 1,
fns = less_1) %>%
fmt("2",
rows = `2` == 0,
fns = no_percent) %>%
fmt("2",
rows = `2` > 99,
fns = greater_99) %>%
fmt("2",
rows = `2` == 100,
fns = percent_100) %>%
fmt("2",
rows = `2` < 99 & `2` >= 1,
fns = nor_percent) %>%
fmt("3",
rows = `3` < 1,
fns = less_1) %>%
fmt("3",
rows = `3` == 0,
fns = no_percent) %>%
fmt("3",
rows = `3` > 99,
fns = greater_99) %>%
fmt("3",
rows = `3` == 100,
fns = percent_100) %>%
fmt("3",
rows = `3` < 99 & `3` >= 1,
fns = nor_percent) %>%
fmt("4",
rows = `4` < 1,
fns = less_1) %>%
fmt("4",
rows = `4` == 0,
fns = no_percent) %>%
fmt("4",
rows = `4` > 99,
fns = greater_99) %>%
fmt("4",
rows = `4` == 100,
fns = percent_100) %>%
fmt("4",
rows = `4` < 99 & `4` >= 1,
fns = nor_percent) %>%
fmt("5",
rows = `5` < 1,
fns = less_1) %>%
fmt("5",
rows = `5` == 0,
fns = no_percent) %>%
fmt("5",
rows = `5` > 99,
fns = greater_99) %>%
fmt("5",
rows = `5` == 100,
fns = percent_100) %>%
fmt("5",
rows = `5` < 99 & `5` >= 1,
fns = nor_percent) %>%
fmt("6",
rows = `6` < 1,
fns = less_1) %>%
fmt("6",
rows = `6` == 0,
fns = no_percent) %>%
fmt("6",
rows = `6` > 99,
fns = greater_99) %>%
fmt("6",
rows = `6` == 100,
fns = percent_100) %>%
fmt("6",
rows = `6` < 99 & `6` >= 1,
fns = nor_percent) %>%
fmt("7",
rows = `7` < 1,
fns = less_1) %>%
fmt("7",
rows = `7` == 0,
fns = no_percent) %>%
fmt("7",
rows = `7` > 99,
fns = greater_99) %>%
fmt("7",
rows = `7` == 100,
fns = percent_100) %>%
fmt("7",
rows = `7` < 99 & `7` >= 1,
fns = nor_percent) %>%
fmt("8",
rows = `8` < 1,
fns = less_1) %>%
fmt("8",
rows = `8` == 0,
fns = no_percent) %>%
fmt("8",
rows = `8` > 99,
fns = greater_99) %>%
fmt("8",
rows = `8` == 100,
fns = percent_100) %>%
fmt("8",
rows = `8` < 99 & `8` >= 1,
fns = nor_percent) %>%
fmt("9",
rows = `9` < 1,
fns = less_1) %>%
fmt("9",
rows = `9` == 0,
fns = no_percent) %>%
fmt("9",
rows = `9` > 99,
fns = greater_99) %>%
fmt("9",
rows = `9` == 100,
fns = percent_100) %>%
fmt("9",
rows = `9` < 99 & `9` >= 1,
fns = nor_percent) %>%
fmt("10",
rows = `10` < 1,
fns = less_1) %>%
fmt("10",
rows = `10` == 0,
fns = no_percent) %>%
fmt("10",
rows = `10` > 99,
fns = greater_99) %>%
fmt("10",
rows = `10` == 100,
fns = percent_100) %>%
fmt("10",
rows = `10` < 99 & `10` >= 1,
fns = nor_percent) %>%
fmt("11",
rows = `11` < 1,
fns = less_1) %>%
fmt("11",
rows = `11` == 0,
fns = no_percent) %>%
fmt("11",
rows = `11` > 99,
fns = greater_99) %>%
fmt("11",
rows = `11` == 100,
fns = percent_100) %>%
fmt("11",
rows = `11` < 99 & `11` >= 1,
fns = nor_percent) %>%
fmt("12",
rows = `12` < 1,
fns = less_1) %>%
fmt("12",
rows = `12` == 0,
fns = no_percent) %>%
fmt("12",
rows = `12` > 99,
fns = greater_99) %>%
fmt("12",
rows = `12` == 100,
fns = percent_100) %>%
fmt("12",
rows = `12` < 99 & `12` >= 1,
fns = nor_percent)
add_fill_table <- range_wins_table %>%
data_color(
columns = `Wins 6`,
colors = scales::col_numeric(
palette = wins_6_fill_scale,
domain = c(0, max_6_wins)
)
) %>%
data_color(
columns = c(`0`,`1`,`2`,`3`,`4`,`5`,`6`,`7`,`8`,`9`,`10`,`11`,`12`),
colors = scales::col_numeric(
palette = wins_6_fill_scale,
domain = c(0, round((max_percent_win)*100,3))
)
)
add_gray_table <- add_fill_table %>%
tab_style(
style = list(
cell_text(color = "gray75")
),
locations = cells_body(
columns = `Wins 6`,
rows = `Wins 6` < 1
)
) %>%
tab_style(
style = list(
cell_text(color = "gray75")
),
locations = cells_body(
columns = `Finishes Out`,
rows = `Finishes Out` < 1
)
) %>%
tab_style(
style = list(
cell_text(color = "gray75")
),
locations = cells_body(
columns = `0`,
rows = `0` < 1
)
) %>%
tab_style(
style = list(
cell_text(color = "gray75")
),
locations = cells_body(
columns = `1`,
rows = `1` < 1
)
)%>%
tab_style(
style = list(
cell_text(color = "gray75")
),
locations = cells_body(
columns = `2`,
rows = `2` < 1
)
)%>%
tab_style(
style = list(
cell_text(color = "gray75")
),
locations = cells_body(
columns = `3`,
rows = `3` < 1
)
)%>%
tab_style(
style = list(
cell_text(color = "gray75")
),
locations = cells_body(
columns = `4`,
rows = `4` < 1
)
)%>%
tab_style(
style = list(
cell_text(color = "gray75")
),
locations = cells_body(
columns = `5`,
rows = `5` < 1
)
)%>%
tab_style(
style = list(
cell_text(color = "gray75")
),
locations = cells_body(
columns = `6`,
rows = `6` < 1
)
)%>%
tab_style(
style = list(
cell_text(color = "gray75")
),
locations = cells_body(
columns = `7`,
rows = `7` < 1
)
)%>%
tab_style(
style = list(
cell_text(color = "gray75")
),
locations = cells_body(
columns = `8`,
rows = `8` < 1
)
)%>%
tab_style(
style = list(
cell_text(color = "gray75")
),
locations = cells_body(
columns = `9`,
rows = `9` < 1
)
)%>%
tab_style(
style = list(
cell_text(color = "gray75")
),
locations = cells_body(
columns = `10`,
rows = `10` < 1
)
)%>%
tab_style(
style = list(
cell_text(color = "gray75")
),
locations = cells_body(
columns = `11`,
rows = `11` < 1
)
)%>%
tab_style(
style = list(
cell_text(color = "gray75")
),
locations = cells_body(
columns = `12`,
rows = `12` < 1
)
)
add_black_table <- add_gray_table %>%
tab_style(
style = list(
cell_text(color = "black")
),
locations = cells_body(
columns = `Wins 6`,
rows = `Wins 6` >= 1
)
) %>%
tab_style(
style = list(
cell_text(color = "black")
),
locations = cells_body(
columns = `Finishes Out`,
rows = `Finishes Out` >= 1
)
) %>%
tab_style(
style = list(
cell_text(color = "black")
),
locations = cells_body(
columns = `0`,
rows = `0` >= 1
)
) %>%
tab_style(
style = list(
cell_text(color = "black")
),
locations = cells_body(
columns = `1`,
rows = `1` >= 1
)
)%>%
tab_style(
style = list(
cell_text(color = "black")
),
locations = cells_body(
columns = `2`,
rows = `2` >= 1
)
)%>%
tab_style(
style = list(
cell_text(color = "black")
),
locations = cells_body(
columns = `3`,
rows = `3` >= 1
)
)%>%
tab_style(
style = list(
cell_text(color = "black")
),
locations = cells_body(
columns = `4`,
rows = `4` >= 1
)
)%>%
tab_style(
style = list(
cell_text(color = "black")
),
locations = cells_body(
columns = `5`,
rows = `5` >= 1
)
)%>%
tab_style(
style = list(
cell_text(color = "black")
),
locations = cells_body(
columns = `6`,
rows = `6` >= 1
)
)%>%
tab_style(
style = list(
cell_text(color = "black")
),
locations = cells_body(
columns = `7`,
rows = `7` >= 1
)
)%>%
tab_style(
style = list(
cell_text(color = "black")
),
locations = cells_body(
columns = `8`,
rows = `8` >= 1
)
)%>%
tab_style(
style = list(
cell_text(color = "black")
),
locations = cells_body(
columns = `9`,
rows = `9` >= 1
)
)%>%
tab_style(
style = list(
cell_text(color = "black")
),
locations = cells_body(
columns = `10`,
rows = `10` >= 1
)
)%>%
tab_style(
style = list(
cell_text(color = "black")
),
locations = cells_body(
columns = `11`,
rows = `11` >= 1
)
)%>%
tab_style(
style = list(
cell_text(color = "black")
),
locations = cells_body(
columns = `12`,
rows = `12` >= 1
)
) %>%
gtsave(glue("{i} Week#{j} game predictions.png"), vwidth = 1100)}
}
}
